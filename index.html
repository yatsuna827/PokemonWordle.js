<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>PokemonWordleCoder</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/codemirror.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/codemirror.min.css">
        <script src="pokemons.js" defer></script>
        <script src="./main.js" defer></script>
        <style>
          body {
            background-color: #ccc;
          }
          .CodeMirror {
            font-family: Monaco, 'Andale Mono', 'Lucida Console', 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;
            font-size: 9pt;
            height: 70vh;
        }
        </style>
    </head>
    <body>
        <textarea id='editor' stype='height: 300px'>
({log, count}, {context, pokemonNames}) => {
    // logには[input,result]のタプルの配列が渡されます。
    // result は 'x','o','@'のいずれかからなる長さ5の文字列で、それぞれ
    // x ... 正解に含まれない
    // o ... 正解に含まれるが位置が一致しない
    // @ ... 正解に含まれ、位置も一致している
    // の意味を持ちます。
    // 
    // count は 現在の入力の回数が渡されます。
    // 無効な入力はcountが増えません。
    
    // contextは1回『実行』ボタンを押してスクリプトが実行される間、保持されます。
    // 前処理を行って格納しておく用途などに使えます。
    // 
    // pokemonNames には、本ゲームに登録されているポケモン名の一覧が渡されます。ご自由にお使いください。
    // (呼び出しごとに新しい配列が渡されるので、破壊的変更を行っても構いませんが、
    //  次の呼び出しに引き継ぎたい場合はcontextに格納する必要があります)
    if(!context.pool) {
        context.pool = pokemonNames.filter((name) => name.length === 5)
        context.total = pokemonNames.length
    }

    if(count == 0) return 'ジーランス'
    if(count == 1) return 'ダルマッカ'
    if(count == 2) return 'ギギギアル'
    if(count == 3) return 'アギルダー'
    
    const rand = Math.floor(Math.random() * context.total)
    
    return context.pool[rand]
}       
</textarea>
        <button id='play-button' onclick='onPlayButtonClicked()'>実行</button>
        <div id='logger'></div>
        <script>
            const editor = CodeMirror.fromTextArea(document.getElementById("editor"), {
                lineNumbers: true
            });
            const onPlayButtonClicked = () => {
                editor.save()
                const rand = Math.floor(Math.random() * five.length)
                
                main(five[rand], pokemonNames, document.getElementById("editor").value)
            }

        </script>
    </body>
</html>